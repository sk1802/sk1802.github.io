<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Fibonacci Walk — Live</title>

<!-- Bootstrap 5 -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

<style>
  body {
    background: radial-gradient(circle at top, #1a1a1a, #0b0b0b);
    color: #eee;
    margin: 0;
    height: 100vh;
    overflow: hidden;
  }

  .sidebar {
    width: 300px;
    background: rgba(20, 20, 20, 0.95);
    border-right: 1px solid #333;
    box-shadow: 0 0 30px rgba(0,0,0,0.6);
  }

  .form-range::-webkit-slider-thumb {
    background-color: #0d6efd;
  }

  .badge {
    font-size: 0.9rem;
  }

  canvas {
    background: #000;
  }

  .title {
    letter-spacing: 0.5px;
  }
</style>
</head>

<body>
<div class="d-flex h-100">

  <!-- Sidebar -->
  <div class="sidebar p-4">
    <h4 class="title mb-4 text-primary">Fibonacci Walk</h4>

    <div class="mb-4">
      <label class="form-label">
        Steps
        <span class="badge bg-primary float-end" id="stepsVal">250</span>
      </label>
      <input type="range" class="form-range" id="steps" min="10" max="500" value="250">
    </div>

    <div class="mb-4">
      <label class="form-label">
        Angle (degrees)
        <span class="badge bg-info float-end" id="angleVal">65</span>
      </label>
      <input type="range" class="form-range" id="angle" min="1" max="180" value="65">
    </div>

    <hr class="border-secondary">

    <p class="small text-muted">
      Even Fibonacci → turn left<br>
      Odd Fibonacci → turn right
    </p>

    <p class="small text-muted mb-0">
      Auto-scaled to fit canvas
    </p>
  </div>

  <!-- Canvas -->
  <div class="flex-grow-1">
    <canvas id="canvas" class="w-100 h-100"></canvas>
  </div>

</div>

<script>
const canvas = document.getElementById("canvas");
const ctx = canvas.getContext("2d");

const stepsSlider = document.getElementById("steps");
const angleSlider = document.getElementById("angle");
const stepsVal = document.getElementById("stepsVal");
const angleVal = document.getElementById("angleVal");

function resize() {
  canvas.width = canvas.clientWidth;
  canvas.height = canvas.clientHeight;
  draw();
}
window.addEventListener("resize", resize);

function fibonacci(n) {
  const fib = [];
  let a = 0, b = 1;
  for (let i = 0; i < n; i++) {
    fib.push(a);
    [a, b] = [b, a + b];
  }
  return fib;
}

function draw() {
  const steps = Number(stepsSlider.value);
  const angleDeg = Number(angleSlider.value);
  const angleRad = angleDeg * Math.PI / 180;

  stepsVal.textContent = steps;
  angleVal.textContent = angleDeg;

  ctx.clearRect(0, 0, canvas.width, canvas.height);

  const fibs = fibonacci(steps);

  let x = 0, y = 0, angle = 0;
  const points = [{ x, y }];

  for (let i = 1; i < fibs.length; i++) {
    angle += (fibs[i] % 2 === 0 ? -1 : 1) * angleRad;
    x += Math.cos(angle);
    y += Math.sin(angle);
    points.push({ x, y });
  }

  let minX = Infinity, maxX = -Infinity;
  let minY = Infinity, maxY = -Infinity;

  for (const p of points) {
    minX = Math.min(minX, p.x);
    maxX = Math.max(maxX, p.x);
    minY = Math.min(minY, p.y);
    maxY = Math.max(maxY, p.y);
  }

  const width = maxX - minX;
  const height = maxY - minY;

  const padding = 50;
  const scale = Math.min(
    (canvas.width - padding) / width,
    (canvas.height - padding) / height
  );

  const offsetX = canvas.width / 2 - (minX + width / 2) * scale;
  const offsetY = canvas.height / 2 - (minY + height / 2) * scale;

  ctx.beginPath();
  ctx.moveTo(
    points[0].x * scale + offsetX,
    points[0].y * scale + offsetY
  );

  for (const p of points) {
    ctx.lineTo(
      p.x * scale + offsetX,
      p.y * scale + offsetY
    );
  }

  ctx.strokeStyle = "#4da3ff";
  ctx.lineWidth = 1.5;
  ctx.stroke();

  // start
  ctx.fillStyle = "lime";
  ctx.beginPath();
  ctx.arc(
    points[0].x * scale + offsetX,
    points[0].y * scale + offsetY,
    4, 0, Math.PI * 2
  );
  ctx.fill();

  // end
  const last = points[points.length - 1];
  ctx.fillStyle = "red";
  ctx.beginPath();
  ctx.arc(
    last.x * scale + offsetX,
    last.y * scale + offsetY,
    4, 0, Math.PI * 2
  );
  ctx.fill();
}

stepsSlider.addEventListener("input", draw);
angleSlider.addEventListener("input", draw);

resize();
</script>
</body>
</html>
